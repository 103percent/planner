.row
  .col.attendances
    - invitations.each do |invitation|
      .row.attendee.mb-3
        .col-1
          - if (invitation.parent.date_and_time - 30.minutes).past?
            - if invitation.attended.nil?
              = link_to admin_workshop_invitation_path(@workshop, invitation, attended: true),
                class: 'verify_attendance', title: 'Verify attendance', method: :put, remote: true,
                data: { disable_with: "<i class='fa fa-spinner spin'></i>" } do
                %i.far.fa-square
            - else
              %i.far.fa-check-square
          - else
            = link_to admin_workshop_invitation_path(@workshop, invitation, attending: false), class: 'cancel_attendance', title: 'Cancel RSVP', data: { confirm: "Are you sure you want to remove #{invitation.member.full_name} from the list of attendees?" }, method: :put, remote: true do
              %i.far.fa-minus-square
        .col-5
          - if invitation.member.newbie?
            %span.has-tip{ 'data-tooltip': '', 'aria-haspopup': 'true', title: 'New attendee.' }
              %i.fas.fa-paw
          - elsif invitation.member.flag_to_organisers?
            %span.has-tip{ 'data-tooltip': '', 'aria-haspopup': 'true', title: 'Multiple no shows and attendance warnings in the last six months' }
              %i.fas.fa-exclamation-circle

          - if invitation.member.recent_notes.any?
            %span.has-tip{ 'data-tooltip': '', 'aria-haspopup': 'true', title: render(partial: 'admin/member_notes/member_note', collection: invitation.member.recent_notes, as: :action) }
              %i.fas.fa-comment

          = link_to admin_member_path(invitation.member) do
            - if invitation.member.full_name.blank?
              = invitation.member.email
            - else
              = invitation.member.full_name
        .col-6
          -if invitation.tutorial?
            %p.mb-1 Tutorial: #{invitation.tutorial}
          -if invitation.note?
            %p.mb-1=invitation.note
          - if invitation.rsvp_time.present?
            %span.has-tip{ 'data-tooltip': '', 'aria-haspopup': 'true',  title: 'Time of RSVP' }
              %p.small
                %i.fas.fa-history
                =l(invitation.rsvp_time)
            - if invitation.automated_rsvp?
              %span.has-tip{ 'data-tooltip': '', 'aria-haspopup': 'true',  title: 'Waiting list or admin addition' }
                %p.small
                  %i.fas.fa-magic
          - if invitation.reminded_at.present?
            %span.has-tip{ 'data-tooltip': '', 'aria-haspopup': 'true',  title: 'Reminder emailed at' }
              %p
                %i.far.fa-clock
                =l(invitation.reminded_at)
